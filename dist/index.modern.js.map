{"version":3,"file":"index.modern.js","sources":["../src/Link.tsx","../src/store.ts","../src/Router.tsx"],"sourcesContent":["import React from 'react'\r\n\r\nconst Link: (Props: {\r\n  href: string\r\n  className: string\r\n  children: React.ReactNode\r\n  onClick?: () => void\r\n}) => JSX.Element = ({ className, href, children, onClick }) => {\r\n  function dispatchHashchange() {\r\n    if (typeof HashChangeEvent !== 'undefined') {\r\n      window.dispatchEvent(new HashChangeEvent('hashchange'))\r\n      return\r\n    }\r\n    try {\r\n      window.dispatchEvent(new Event('hashchange'))\r\n      return\r\n    } catch (error) {\r\n      console.log(error)\r\n    }\r\n    const ieEvent = document.createEvent('Event')\r\n    ieEvent.initEvent('hashchange', true, true)\r\n    window.dispatchEvent(ieEvent)\r\n  }\r\n\r\n  const onClickLink = (event: React.MouseEvent<HTMLElement>) => {\r\n    event.preventDefault()\r\n    dispatchHashchange()\r\n    if (event.metaKey || event.ctrlKey) {\r\n      return\r\n    }\r\n    {\r\n      onClick ? onClick() : null\r\n    }\r\n    window.history.pushState({}, '', href)\r\n    const navEvent = new PopStateEvent('popstate')\r\n    window.dispatchEvent(navEvent)\r\n  }\r\n\r\n  return (\r\n    <a className={className} href={href} onClick={onClickLink}>\r\n      {children}\r\n    </a>\r\n  )\r\n}\r\n\r\nexport default Link\r\n","interface ctxType {\r\n  query: { [index: string]: string }\r\n}\r\n\r\nexport const ctx = {\r\n  query: {}\r\n} as ctxType\r\n\r\nexport const reset = () => {\r\n  ctx.query = {}\r\n}\r\n","import React, { useEffect, useState } from 'react'\r\nimport { ctx, reset } from './store'\r\n\r\nconst hashReader = (str: string) => {\r\n  const patt1 = /[0-9]/g\r\n  const patt2 = /[a-zA-Z]/g\r\n  if (!str) return { numbers: '', letters: '' }\r\n  const letters = str.match(patt2)?.join('')\r\n  const digits = str.match(patt1)?.join('')\r\n  return { letters, digits }\r\n}\r\n\r\nconst comparePaths = (path: string, dynamicPath: string) => {\r\n  const pathSplit = path.split('/')\r\n  const dynamicPathSplit = dynamicPath.split('/')\r\n  if (pathSplit.length !== dynamicPathSplit.length) return false\r\n  let isMatch = true\r\n  pathSplit.forEach((item, index) => {\r\n    if (\r\n      item !== dynamicPathSplit[index] &&\r\n      !dynamicPathSplit[index]?.includes(':')\r\n    ) {\r\n      isMatch = false\r\n    }\r\n  })\r\n\r\n  if (isMatch) {\r\n    dynamicPathSplit.map((item, index) => {\r\n      if (item.includes(':')) {\r\n        const key = item.replace(':', '')\r\n        ctx.query[key] = pathSplit[index]\r\n        console.log('ctx', ctx)\r\n      }\r\n    })\r\n  }\r\n  return isMatch\r\n}\r\n\r\nconst Router: (\r\n  Routes: {\r\n    path?: string\r\n    hash?: string\r\n    children: React.ReactNode\r\n  }[],\r\n  NotFound: React.ReactNode\r\n) => JSX.Element = (Routes, NotFound) => {\r\n  const [currentPath, setCurrentPath] = useState(window.location.pathname)\r\n  const [currentHash, setCurrentHash] = useState(window.location.hash)\r\n\r\n  const getCorrect = (path: string) => {\r\n    const { letters, digits } = hashReader(currentHash)\r\n    if (letters && digits) {\r\n      const correchash = Routes.find((item) => item.hash === letters)\r\n      return (correchash?.children as JSX.Element) || NotFound\r\n    }\r\n    const dynamicPath = Routes.filter((item) => item.path?.includes(':'))\r\n    const testChil = dynamicPath.map((item) => {\r\n      if (comparePaths(path, item.path || '')) {\r\n        return item.children as JSX.Element\r\n      }\r\n      return null\r\n    })\r\n    const finChil = testChil.filter((item) => item)\r\n    if (finChil.length > 0) {\r\n      return finChil[0] as JSX.Element\r\n    }\r\n    const correct = Routes.find((item) => item.path === path)\r\n    return (correct?.children as JSX.Element) || NotFound\r\n  }\r\n\r\n  useEffect(() => {\r\n    const onLocationChange = () => {\r\n      reset()\r\n      setCurrentPath(window.location.pathname)\r\n      setCurrentHash(window.location.hash)\r\n    }\r\n    const onHashChange = () => {\r\n      setCurrentPath(window.location.pathname)\r\n      setCurrentHash(window.location.hash)\r\n    }\r\n    window.addEventListener('popstate', onLocationChange)\r\n    window.addEventListener('hashchange', onHashChange)\r\n    return () => {\r\n      window.removeEventListener('popstate', onLocationChange)\r\n      window.removeEventListener('hashchange', onHashChange)\r\n    }\r\n  }, [])\r\n  return getCorrect(currentPath)\r\n}\r\n\r\nexport default Router\r\n"],"names":["Link","className","href","children","onClick","dispatchHashchange","HashChangeEvent","window","dispatchEvent","Event","error","console","log","ieEvent","document","createEvent","initEvent","onClickLink","event","preventDefault","metaKey","ctrlKey","history","pushState","navEvent","PopStateEvent","React","ctx","query","reset","hashReader","str","patt1","patt2","numbers","letters","match","join","digits","comparePaths","path","dynamicPath","pathSplit","split","dynamicPathSplit","length","isMatch","forEach","item","index","includes","map","key","replace","Router","Routes","NotFound","useState","location","pathname","currentPath","setCurrentPath","hash","currentHash","setCurrentHash","getCorrect","correchash","find","filter","testChil","finChil","correct","useEffect","onLocationChange","onHashChange","addEventListener","removeEventListener"],"mappings":";;AAEA,IAAMA,IAAI,GAKU,SALdA,IAAI;MAKaC,SAAS,QAATA,SAAS;IAAEC,IAAI,QAAJA,IAAI;IAAEC,QAAQ,QAARA,QAAQ;IAAEC,OAAO,QAAPA,OAAO;EACvD,SAASC,kBAAkB;IACzB,IAAI,OAAOC,eAAe,KAAK,WAAW,EAAE;MAC1CC,MAAM,CAACC,aAAa,CAAC,IAAIF,eAAe,CAAC,YAAY,CAAC,CAAC;MACvD;;IAEF,IAAI;MACFC,MAAM,CAACC,aAAa,CAAC,IAAIC,KAAK,CAAC,YAAY,CAAC,CAAC;MAC7C;KACD,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;;IAEpB,IAAMG,OAAO,GAAGC,QAAQ,CAACC,WAAW,CAAC,OAAO,CAAC;IAC7CF,OAAO,CAACG,SAAS,CAAC,YAAY,EAAE,IAAI,EAAE,IAAI,CAAC;IAC3CT,MAAM,CAACC,aAAa,CAACK,OAAO,CAAC;;EAG/B,IAAMI,WAAW,GAAG,SAAdA,WAAW,CAAIC,KAAoC;IACvDA,KAAK,CAACC,cAAc,EAAE;IACtBd,kBAAkB,EAAE;IACpB,IAAIa,KAAK,CAACE,OAAO,IAAIF,KAAK,CAACG,OAAO,EAAE;MAClC;;IAEF;MACEjB,OAAO,GAAGA,OAAO,EAAE,GAAG,IAAI;;IAE5BG,MAAM,CAACe,OAAO,CAACC,SAAS,CAAC,EAAE,EAAE,EAAE,EAAErB,IAAI,CAAC;IACtC,IAAMsB,QAAQ,GAAG,IAAIC,aAAa,CAAC,UAAU,CAAC;IAC9ClB,MAAM,CAACC,aAAa,CAACgB,QAAQ,CAAC;GAC/B;EAED,OACEE;IAAGzB,SAAS,EAAEA,SAAS;IAAEC,IAAI,EAAEA,IAAI;IAAEE,OAAO,EAAEa;KAC3Cd,QAAQ,CACP;AAER,CAAC;;ICvCYwB,GAAG,GAAG;EACjBC,KAAK,EAAE;CACG;AAEZ,AAAO,IAAMC,KAAK,GAAG,SAARA,KAAK;EAChBF,GAAG,CAACC,KAAK,GAAG,EAAE;AAChB,CAAC;;ACPD,IAAME,UAAU,GAAG,SAAbA,UAAU,CAAIC,GAAW;;EAC7B,IAAMC,KAAK,GAAG,QAAQ;EACtB,IAAMC,KAAK,GAAG,WAAW;EACzB,IAAI,CAACF,GAAG,EAAE,OAAO;IAAEG,OAAO,EAAE,EAAE;IAAEC,OAAO,EAAE;GAAI;EAC7C,IAAMA,OAAO,iBAAGJ,GAAG,CAACK,KAAK,CAACH,KAAK,CAAC,+CAAhB,WAAkBI,IAAI,CAAC,EAAE,CAAC;EAC1C,IAAMC,MAAM,kBAAGP,GAAG,CAACK,KAAK,CAACJ,KAAK,CAAC,gDAAhB,YAAkBK,IAAI,CAAC,EAAE,CAAC;EACzC,OAAO;IAAEF,OAAO,EAAPA,OAAO;IAAEG,MAAM,EAANA;GAAQ;AAC5B,CAAC;AAED,IAAMC,YAAY,GAAG,SAAfA,YAAY,CAAIC,IAAY,EAAEC,WAAmB;EACrD,IAAMC,SAAS,GAAGF,IAAI,CAACG,KAAK,CAAC,GAAG,CAAC;EACjC,IAAMC,gBAAgB,GAAGH,WAAW,CAACE,KAAK,CAAC,GAAG,CAAC;EAC/C,IAAID,SAAS,CAACG,MAAM,KAAKD,gBAAgB,CAACC,MAAM,EAAE,OAAO,KAAK;EAC9D,IAAIC,OAAO,GAAG,IAAI;EAClBJ,SAAS,CAACK,OAAO,CAAC,UAACC,IAAI,EAAEC,KAAK;;IAC5B,IACED,IAAI,KAAKJ,gBAAgB,CAACK,KAAK,CAAC,IAChC,2BAACL,gBAAgB,CAACK,KAAK,CAAC,kDAAvB,sBAAyBC,QAAQ,CAAC,GAAG,CAAC,GACvC;MACAJ,OAAO,GAAG,KAAK;;GAElB,CAAC;EAEF,IAAIA,OAAO,EAAE;IACXF,gBAAgB,CAACO,GAAG,CAAC,UAACH,IAAI,EAAEC,KAAK;MAC/B,IAAID,IAAI,CAACE,QAAQ,CAAC,GAAG,CAAC,EAAE;QACtB,IAAME,GAAG,GAAGJ,IAAI,CAACK,OAAO,CAAC,GAAG,EAAE,EAAE,CAAC;QACjC1B,GAAG,CAACC,KAAK,CAACwB,GAAG,CAAC,GAAGV,SAAS,CAACO,KAAK,CAAC;QACjCtC,OAAO,CAACC,GAAG,CAAC,KAAK,EAAEe,GAAG,CAAC;;KAE1B,CAAC;;EAEJ,OAAOmB,OAAO;AAChB,CAAC;AAED,IAAMQ,MAAM,GAOO,SAPbA,MAAM,CAOQC,MAAM,EAAEC,QAAQ;EAClC,gBAAsCC,QAAQ,CAAClD,MAAM,CAACmD,QAAQ,CAACC,QAAQ,CAAC;IAAjEC,WAAW;IAAEC,cAAc;EAClC,iBAAsCJ,QAAQ,CAAClD,MAAM,CAACmD,QAAQ,CAACI,IAAI,CAAC;IAA7DC,WAAW;IAAEC,cAAc;EAElC,IAAMC,UAAU,GAAG,SAAbA,UAAU,CAAIzB,IAAY;IAC9B,kBAA4BV,UAAU,CAACiC,WAAW,CAAC;MAA3C5B,OAAO,eAAPA,OAAO;MAAEG,MAAM,eAANA,MAAM;IACvB,IAAIH,OAAO,IAAIG,MAAM,EAAE;MACrB,IAAM4B,UAAU,GAAGX,MAAM,CAACY,IAAI,CAAC,UAACnB,IAAI;QAAA,OAAKA,IAAI,CAACc,IAAI,KAAK3B,OAAO;QAAC;MAC/D,OAAQ,CAAA+B,UAAU,aAAVA,UAAU,uBAAVA,UAAU,CAAE/D,QAAwB,KAAIqD,QAAQ;;IAE1D,IAAMf,WAAW,GAAGc,MAAM,CAACa,MAAM,CAAC,UAACpB,IAAI;MAAA;MAAA,qBAAKA,IAAI,CAACR,IAAI,+CAAT,WAAWU,QAAQ,CAAC,GAAG,CAAC;MAAC;IACrE,IAAMmB,QAAQ,GAAG5B,WAAW,CAACU,GAAG,CAAC,UAACH,IAAI;MACpC,IAAIT,YAAY,CAACC,IAAI,EAAEQ,IAAI,CAACR,IAAI,IAAI,EAAE,CAAC,EAAE;QACvC,OAAOQ,IAAI,CAAC7C,QAAuB;;MAErC,OAAO,IAAI;KACZ,CAAC;IACF,IAAMmE,OAAO,GAAGD,QAAQ,CAACD,MAAM,CAAC,UAACpB,IAAI;MAAA,OAAKA,IAAI;MAAC;IAC/C,IAAIsB,OAAO,CAACzB,MAAM,GAAG,CAAC,EAAE;MACtB,OAAOyB,OAAO,CAAC,CAAC,CAAgB;;IAElC,IAAMC,OAAO,GAAGhB,MAAM,CAACY,IAAI,CAAC,UAACnB,IAAI;MAAA,OAAKA,IAAI,CAACR,IAAI,KAAKA,IAAI;MAAC;IACzD,OAAQ,CAAA+B,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEpE,QAAwB,KAAIqD,QAAQ;GACtD;EAEDgB,SAAS,CAAC;IACR,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAgB;MACpB5C,KAAK,EAAE;MACPgC,cAAc,CAACtD,MAAM,CAACmD,QAAQ,CAACC,QAAQ,CAAC;MACxCK,cAAc,CAACzD,MAAM,CAACmD,QAAQ,CAACI,IAAI,CAAC;KACrC;IACD,IAAMY,YAAY,GAAG,SAAfA,YAAY;MAChBb,cAAc,CAACtD,MAAM,CAACmD,QAAQ,CAACC,QAAQ,CAAC;MACxCK,cAAc,CAACzD,MAAM,CAACmD,QAAQ,CAACI,IAAI,CAAC;KACrC;IACDvD,MAAM,CAACoE,gBAAgB,CAAC,UAAU,EAAEF,gBAAgB,CAAC;IACrDlE,MAAM,CAACoE,gBAAgB,CAAC,YAAY,EAAED,YAAY,CAAC;IACnD,OAAO;MACLnE,MAAM,CAACqE,mBAAmB,CAAC,UAAU,EAAEH,gBAAgB,CAAC;MACxDlE,MAAM,CAACqE,mBAAmB,CAAC,YAAY,EAAEF,YAAY,CAAC;KACvD;GACF,EAAE,EAAE,CAAC;EACN,OAAOT,UAAU,CAACL,WAAW,CAAC;AAChC,CAAC;;;;"}