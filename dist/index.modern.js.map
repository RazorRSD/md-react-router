{"version":3,"file":"index.modern.js","sources":["../src/Router.tsx","../src/funcs.tsx","../src/Link.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\n\r\nconst hashReader = (str: string) => {\r\n  const patt1 = /[0-9]/g\r\n  const patt2 = /[a-zA-Z]/g\r\n  if (!str) return { numbers: '', letters: '' }\r\n  const letters = str.match(patt2)?.join('')\r\n  const digits = str.match(patt1)?.join('')\r\n  return { letters, digits }\r\n}\r\n\r\nconst Router: (props: {\r\n  path?: string\r\n  hash?: string\r\n  onCallback?: () => void\r\n  children: React.ReactNode\r\n}) => JSX.Element | null = ({ path, hash, children, onCallback }) => {\r\n  const [currentPath, setCurrentPath] = useState(window.location.pathname)\r\n  const [currentHash, setCurrentHash] = useState(window.location.hash)\r\n\r\n  useEffect(() => {\r\n    const onLocationChange = () => {\r\n      setCurrentPath(window.location.pathname)\r\n      setCurrentHash(window.location.hash)\r\n      {\r\n        onCallback ? onCallback() : null\r\n      }\r\n    }\r\n    const onHashChange = () => {\r\n      setCurrentPath(window.location.pathname)\r\n      setCurrentHash(window.location.hash)\r\n      {\r\n        onCallback ? onCallback() : null\r\n      }\r\n    }\r\n    window.addEventListener('popstate', onLocationChange)\r\n    window.addEventListener('hashchange', onHashChange)\r\n    return () => {\r\n      window.removeEventListener('popstate', onLocationChange)\r\n      window.removeEventListener('hashchange', onHashChange)\r\n    }\r\n  }, [])\r\n\r\n  if (currentHash) {\r\n    const { letters } = hashReader(currentHash)\r\n    if (letters === hash) return children as JSX.Element\r\n    else return null\r\n  } else {\r\n    return currentPath === path ? (children as JSX.Element) : null\r\n  }\r\n}\r\n\r\nexport default Router\r\n","import React from 'react'\r\nimport Router from './Router'\r\n\r\nconst getRoutes = (\r\n  routes: {\r\n    path?: string\r\n    hash?: string\r\n    component: React.FunctionComponent\r\n    onCallback?: () => void\r\n  }[],\r\n  notFound?: React.FunctionComponent\r\n) => {\r\n  const notFoundComp = () => {\r\n    return notFound ? notFound : <div>404</div>\r\n  }\r\n  return routes.map((prop, key) => {\r\n    return Router ? (\r\n      <Router\r\n        path={prop.path}\r\n        hash={prop.hash}\r\n        key={key}\r\n        onCallback={prop.onCallback}\r\n      >\r\n        <prop.component />\r\n      </Router>\r\n    ) : (\r\n      notFoundComp\r\n    )\r\n  })\r\n}\r\n\r\nexport default getRoutes\r\n","import React from 'react'\r\n\r\nconst Link: (Props: {\r\n  href: string\r\n  className: string\r\n  children: React.ReactNode\r\n  onClick?: () => void\r\n}) => JSX.Element = ({ className, href, children, onClick }) => {\r\n  function dispatchHashchange() {\r\n    if (typeof HashChangeEvent !== 'undefined') {\r\n      window.dispatchEvent(new HashChangeEvent('hashchange'))\r\n      return\r\n    }\r\n    try {\r\n      window.dispatchEvent(new Event('hashchange'))\r\n      return\r\n    } catch (error) {\r\n      console.log(error)\r\n    }\r\n    const ieEvent = document.createEvent('Event')\r\n    ieEvent.initEvent('hashchange', true, true)\r\n    window.dispatchEvent(ieEvent)\r\n  }\r\n\r\n  const onClickLink = (event: React.MouseEvent<HTMLElement>) => {\r\n    event.preventDefault()\r\n    dispatchHashchange()\r\n    if (event.metaKey || event.ctrlKey) {\r\n      return\r\n    }\r\n    {\r\n      onClick ? onClick() : null\r\n    }\r\n    window.history.pushState({}, '', href)\r\n    const navEvent = new PopStateEvent('popstate')\r\n    window.dispatchEvent(navEvent)\r\n  }\r\n\r\n  return (\r\n    <a className={className} href={href} onClick={onClickLink}>\r\n      {children}\r\n    </a>\r\n  )\r\n}\r\n\r\nexport default Link\r\n"],"names":["hashReader","str","patt1","patt2","numbers","letters","match","join","digits","Router","path","hash","children","onCallback","currentPath","setCurrentPath","useState","window","location","pathname","currentHash","setCurrentHash","useEffect","onLocationChange","onHashChange","addEventListener","removeEventListener","getRoutes","routes","notFound","notFoundComp","React","map","prop","key","component","Link","className","href","onClick","dispatchHashchange","HashChangeEvent","dispatchEvent","Event","error","console","log","ieEvent","document","createEvent","initEvent","onClickLink","event","preventDefault","metaKey","ctrlKey","history","pushState","navEvent","PopStateEvent"],"mappings":"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"}